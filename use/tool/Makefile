################################################################
###################支持C/C++混合编译############################
################################################################
PRJ_ROOT= 						#一般不用更改,这里可以添加头文件的路径，接在LDFLAGS后面，方便使用
CC=g++								#编译器，编译C文件选择gcc，编译C++文件选着g++(最好选g++，因为其兼容C)
CFLAGS=               #如果需要调试，在这里增加-g选项,还可以根据自己的需要添加响应的选项命令
CPPFLAGS=             #同上
LDFLAGS=-std=c++11 -lpthread

################################################################
###########源文件，每增加一个目标，依样增加下面一段#############
################################################################

#源文件列表1
i:=1
SOURCES_CPP_$(i):=test.cpp         									#在这里添加、修改当前目标需要的CPP源码
SOURCES_C_$(i):= 																		#在这里添加、修改当前目标需要的C源码
TARGET_$(i):=testcpp       													#目标名称
OBJS_CPP_$(i):=$(patsubst %.cpp,%.o, $(SOURCES_CPP_$(i)))
OBJS_C_$(i):= $(patsubst %.c,%.o, $(SOURCES_C_$(i)))
OBJS_$(i):= $(OBJS_CPP_$(i)) $(OBJS_C_$(i))


#源文件列表2 
i:=2
SOURCES_CPP_$(i):=
SOURCES_C_$(i):=main.c
TARGET_$(i):=mainc
OBJS_CPP_$(i):=$(patsubst %.cpp,%.o, $(SOURCES_CPP_$(i)))
OBJS_C_$(i):= $(patsubst %.c,%.o, $(SOURCES_C_$(i)))
OBJS_$(i):= $(OBJS_CPP_$(i)) $(OBJS_C_$(i))


################################################################
#######目标和清除 每增加一个目标，依样增加一个target############
################################################################

all: $(TARGET_1) $(TARGET_2)
	@echo "outputfile : $(TARGET_1) $(TARGET_2)"
clean:
	rm -f *.o  *.d  $(TARGET_1) $(TARGET_2)


################################################################
##########目标， 每增加一个目标，依样增加下面一段###############
################################################################

#目标1 
$(TARGET_1):$(OBJS_1)
	$(CC) $(OBJS_1) $(LDFLAGS) -o $(TARGET_1)

#目标2
$(TARGET_2):$(OBJS_2)
	$(CC) $(OBJS_2) $(LDFLAGS) -o $(TARGET_2)


################################################################
###########包含 每增加一个目标，依样增加下面一行################
################################################################

sinclude $(OBJS_1:.o=.d)
	sinclude $(OBJS_2:.o=.d)



############################################################
#################下面的内容可以不用更改#####################
############################################################

#下面这边都是获取依赖关系 ，属于约定俗成的写法,不用更改
%.d: %.c
	@rm -f $@;
	@$(CC) -MM $< > $@.1111; \
		sed 's,/($*/)/.o[ :]*,/1.o $@ : ,g' < $@.1111 > $@;  \
		rm -f $@.1111

%.d: %.cpp
	@rm -f $@;
	@$(CC) -MM $< > $@.1111; \
		sed 's,/($*/)/.o[ :]*,/1.o $@ : ,g' < $@.1111 > $@;  \
		rm -f $@.1111
